---
import Layout from "../layouts/Layout.astro";
import { sendMessage } from "../../backend/backend.mjs";
import {addFilm} from "../../backend/backend.mjs";


let message = "";
if (Astro.request.method === "POST") {
  const formData = await Astro.request.formData();
  const response = await addFilm(formData);
  message = response.message;
}
---

<Layout>
  <h1 class="text-3xl font-bold text-beige-600 text-start my-6">
    Envoyez nous votre film pour participer
  </h1>
  <div>
  <form
    class="flex flex-col gap-4 mt-5 p-6 bg-white shadow-lg rounded-lg max-w-md mx-auto mb-10"
    action="/offres/add"
    method="POST"
    enctype="multipart/form-data"
  >
    <input
      class="w-full mt-2 p-2 border border-gray-300 rounded-md"
      type="text"
      name="nom"
      placeholder="Nom fu film"
      required
    />

    <input
      type="number"
      name="duree"
      placeholder="Durée"
      class="p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <input
      type="text"
      name="langue"
      placeholder="Langue"
      class="p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <input
      type="text"
      name="genre"
      placeholder="Genre"
      class="p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <input
      type="text"
      name="description_film"
      placeholder="Synopsis"
      class="p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <input type="file" name="affiche" />

    <button
      type="submit"
      class="bg-green-600 text-white rounded-md w-28 max-w-lg mt-7"
    >
      Ajouter
    </button>
</div>
    <h1 class="text-3xl font-bold text-beige-600 text-start my-6">
      Laissez nous un message
    </h1>

    <form
      class="flex flex-col gap-4 max-w-lg mx-auto p-6 bg-white shadow-lg rounded-lg"
      action=""
      method="POST"
    >
      <label class="font-medium text-gray-700">
        Nom complet
        <input
          type="text"
          name="nom"
          placeholder="Votre nom"
          required
          class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:outline-none"
        />
      </label>

      <label class="font-medium text-gray-700">
        Email
        <input
          type="email"
          name="email"
          placeholder="Votre email"
          required
          class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:outline-none"
        />
      </label>

      <label class="font-medium text-gray-700">
        Sujet
        <input
          type="text"
          name="sujet"
          placeholder="Objet de votre message"
          required
          class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:outline-none"
        />
      </label>

      <label class="font-medium text-gray-700">
        Message
        <textarea
          name="message"
          rows="5"
          placeholder="Votre message ici..."
          required
          class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:outline-none"
        ></textarea>
      </label>

      <button
        type="submit"
        class="bg-orange-600 text-white font-bold py-3 rounded-md hover:bg-orange-700 transition"
      >
        Envoyer
      </button>
    </form>

    {
      message && (
        <p
          class={`mt-4 text-center font-bold p-3 rounded-md ${
            message.includes("succès")
              ? "text-green-800 bg-green-100"
              : "text-red-800 bg-red-100"
          }`}
        >
          {message}
        </p>
      )
    }
  </form>
</Layout>
