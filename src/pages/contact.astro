---
import Layout from "../layouts/Layout.astro";
import { sendMessage } from "../../backend/backend.mjs";

let message = "";
if (Astro.request.method === "POST") {
  const formData = await Astro.request.formData();
  const response = await sendMessage(formData);
  message = response.message;
}
---

<Layout>
  <h1 class="text-3xl font-bold text-orange-600 text-center my-6">
    Contactez-nous
  </h1>

  <form
    class="flex flex-col gap-4 max-w-lg mx-auto p-6 bg-white shadow-lg rounded-lg"
    action=""
    method="POST"
  >
    <!-- Nom -->
    <label class="font-medium text-gray-700">
      Nom complet
      <input
        type="text"
        name="nom"
        placeholder="Votre nom"
        required
        class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:outline-none"
      />
    </label>

    <!-- Email -->
    <label class="font-medium text-gray-700">
      Email
      <input
        type="email"
        name="email"
        placeholder="Votre email"
        required
        class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:outline-none"
      />
    </label>

    <!-- Sujet -->
    <label class="font-medium text-gray-700">
      Sujet
      <input
        type="text"
        name="sujet"
        placeholder="Objet de votre message"
        required
        class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:outline-none"
      />
    </label>

    <!-- Message -->
    <label class="font-medium text-gray-700">
      Message
      <textarea
        name="message"
        rows="5"
        placeholder="Votre message ici..."
        required
        class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:outline-none"
      ></textarea>
    </label>

    <!-- Bouton de soumission -->
    <button
      type="submit"
      class="bg-orange-600 text-white font-bold py-3 rounded-md hover:bg-orange-700 transition"
    >
      Envoyer
    </button>
  </form>

  <!-- Affichage du message de retour -->
  {
    message && (
      <p
        class={`mt-4 text-center font-bold p-3 rounded-md ${
          message.includes("succÃ¨s")
            ? "text-green-800 bg-green-100"
            : "text-red-800 bg-red-100"
        }`}
      >
        {message}
      </p>
    )
  }
</Layout>
